# ๐ฉบ Healthy API - ูุงูุชูุฑูฺฏ ูพุดุฑูุชู ุณุฑูุณโูุง

**Healthy API** ฺฉ ุงุจุฒุงุฑ ูุฏุฑุชููุฏ ู ูุงุจู ุชูุณุนู ุจุฑุง ูุงูุชูุฑูฺฏ ูุญุธูโุง ุณูุงูุช (Health Check) ูุจโุณุฑูุณโูุง ุดูุงุณุช. ุงู ูพุฑูฺู ุจุง ุฒุจุงู **Go** ููุดุชู ุดุฏู ู ุจู ุดูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุจุง ุจุฑุฑุณโูุง ุฏูุฑูโุงุ ุงุฒ ุฏุฑ ุฏุณุชุฑุณ ุจูุฏู (Availability) ู ุนููฺฉุฑุฏ ุตุญุญ ุณุฑูุณโูุงุชุงู ูุทูุฆู ุดูุฏ ู ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุฑฺฏููู ูุดฺฉูุ ุจูุงูุงุตูู ุงุฒ ุทุฑู ฺฉุงูุงูโูุง ูุฎุชูู (ุงูู ู ูพุงูฺฉ) ุจุง ุฎุจุฑ ุดูุฏ.

---

## โจ ุงูฺฉุงูุงุช ฺฉูุฏ

- **ูุงูุชูุฑูฺฏ ฺูุฏู ุณุฑูุณ:** ูุงุจูุช ุชุนุฑู ู ูุงูุชูุฑูฺฏ ููุฒูุงู ุชุนุฏุงุฏ ูุงูุญุฏูุฏ ุณุฑูุณ.
- **ุณุณุชู ูุดุฏุงุฑ ฺูุฏ ฺฉุงูุงูู:** ุงุฑุณุงู ููุชูฺฉุดู ุงุฒ ุทุฑู **ุงูู (SMTP)** ู **ูพุงูฺฉ (IPPanel)** ุจุง ูุนูุงุฑ ูุงุจู ุชูุณุนู ุจุฑุง ุงูุฒูุฏู ฺฉุงูุงูโูุง ุฌุฏุฏ.
- **ุจุฑุฑุณโูุง ุฏูุฑูโุง ููุดููุฏ:** ุชูุธู ุจุงุฒูโูุง ุฒูุงู ุฏูุฎูุงู ุจุฑุง ฺฺฉ ฺฉุฑุฏู ูุฑ ุณุฑูุณ.
- **ุฌููฺฏุฑ ุงุฒ ุงุณูพู (Spam):** ูุงุจูุช ุชุนุฑู ฺฉ ุฏูุฑู ุฒูุงู ุณฺฉูุช (`sleep_on_fail`) ูพุณ ุงุฒ ุดูุงุณุง ุฎุทุง ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุฑุณุงู ูุดุฏุงุฑูุง ุชฺฉุฑุงุฑ.
- **ุดุฑุงุท ุจุฑุฑุณ ูุงุจู ุชูุธู:** ุงูฺฉุงู ุชุนุฑู **ฺฉุฏ ูุถุนุช HTTP** ููุฑุฏ ุงูุชุธุงุฑ (`expected_status_code`) ุจุฑุง ูุฑ ุณุฑูุณ.
- **ุงุฌุฑุง ููุฒูุงู (Concurrent):** ุงุณุชูุงุฏู ุงุฒ Goroutine ุจุฑุง ูุงูุชูุฑูฺฏ ุชูุงู ุณุฑูุณโูุง ุจู ุตูุฑุช ููุฒูุงู ู ุจุฏูู ุชุฏุงุฎู.
- **ูพฺฉุฑุจูุฏ ุขุณุงู:** ุชูุงู ุชูุธูุงุช ูพุฑูฺู ุงุฒ ุทุฑู ฺฉ ูุงู `YAML` ุณุงุฏู ู ุฎูุงูุง ูุฏุฑุช ูโุดูุฏ.

---

## ๐ ุดุฑูุน ุจู ฺฉุงุฑ

### ูพุดโูุงุฒูุง

- **Go 1.21+**
- ุฏุณุชุฑุณ ุจู ฺฉ ุณุฑูุณ ุงูู (SMTP) ุง ูพูู ูพุงูฺฉ (ูุงููุฏ IPPanel)

### ุงุฌุฑุง

ฑ. ูพุฑูฺู ุฑุง Clone ฺฉูุฏ:
```bash
git clone https://github.com/mosishon/healthy-api.git
cd healthy-api
```

ฒ. ฺฉ ูุงู ูพฺฉุฑุจูุฏ (ูุซูุงู `config.yaml`) ุจุฑ ุงุณุงุณ ููููู ุฒุฑ ุจุณุงุฒุฏ.

ณ. ุจุฑูุงูู ุฑุง ุจุง ุฏุณุชูุฑ ุฒุฑ ุงุฌุฑุง ฺฉูุฏ:
```bash
go run main.go -config=config.yaml
```

ุง ูโุชูุงูุฏ ุงุจุชุฏุง ูุงู ุงุฌุฑุง ุฑุง ุจุณุงุฒุฏ:
```bash
go build -o healthy-api
./healthy-api -config=config.yaml -verbose
```
> ุงุฒ ููฺฏ `-verbose` ุจุฑุง ุฏุฏู ูุงฺฏโูุง ฺฉุงูู ุจุฑูุงูู ุงุณุชูุงุฏู ฺฉูุฏ.

---

## โ๏ธ ูพฺฉุฑุจูุฏ (Configuration)

ุชูุงู ุชูุธูุงุช ุฏุฑ ฺฉ ูุงู YAML ูุฏุฑุช ูโุดููุฏ. ุณุงุฎุชุงุฑ ุงู ูุงู ุจู ุดฺฉู ุฒุฑ ุงุณุช:

```yaml
#===========================================
#        ุณุฑูุณโูุง ุชุญุช ูุงูุชูุฑูฺฏ
#===========================================
services:
  - name: "production-api-service" # ูุงู ุณุฑูุณ ุฌูุช ููุงุด ุฏุฑ ูุดุฏุงุฑ ูุง
    url: "https://api.my-domain.com/health"
    
    expected_status_code: 200 # ูุถุนุช ููููุชโุขูุฒ ุฑู 200 ุฏุฑ ูุธุฑ ุจฺฏุฑ
    check_period: 60 # ูุฑ 60 ุซุงูู ฺฉโุจุงุฑ ฺฺฉ ฺฉู
    sleep_on_fail: 300 # ุงฺฏุฑ ุณุฑูุณ ุฏุฑ ูุถุนุช ุงุดุชุจุงู ุจูุฏุ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุณูพูุ ุชุง 5 ุฏููู ุจุนุฏุด ฺฺฉ ูฺฉู
    # ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉูุ ุจู ุงู ฺฉุงูุงูโูุง ูุดุฏุงุฑ ุจูุฑุณุช
    targets:
      - notifier_id: "admins-email-group"
        recipients:
          - "admin1@example.com"
          - "cto@example.com"
      - notifier_id: "on-call-sms-alert"
        recipients:
          - "+989120000001"
      - notifier_id: "slack-notification-hook"
        recipients:
          # ุดูุง ูโุชูุงูุฏ ฺูุฏู ุขุฏุฑุณ ูุจโููฺฉ ุฑุง ุจุฑุง ฺฉ ุดูุงุณู ุชุนุฑู ฺฉูุฏ
          - "https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX"
          - "https://your-custom-api-endpoint.com/notify"

#===========================================
#        ูพฺฉุฑุจูุฏ ฺฉุงูุงูโูุง ุงุทูุงุนโุฑุณุงู
#===========================================
notifiers:
  # ------ ุณุฑูุฑูุง ุงูู (SMTP) ------
  smtp:
    - id: personal_smtp
      sender: "notifier@your-domain.com"
      password: "your-smtp-password"
      server: "smtp.your-domain.com"
      port: 587

  # ------ ูพููโูุง ูพุงูฺฉ (ูุงููุฏ IPPanel) ------
  ippanel: 
    - id: work_sms
      url: <YOUR_IPPANEL_URL>
      user: <YOUR_IPPANEL_USERNAME>
      pass: <YOUR_IPPANEL_PASSWORD>

  # ------ ูุจโููฺฉโูุง (ุจุฑุง ุงุฑุณุงู POST Request ุจุง ูุงูุจ ุฏูุฎูุงู) ------
  webhook:
    - id: "slack-notification-hook"
      # ูุชุฏ HTTP ฺฉู ุจุฑุง ุงุฑุณุงู ูุจโููฺฉ ุงุณุชูุงุฏู ูโุดูุฏ (ูุซูุงู POST, PUT)
      method: POST
      # ูุฏุฑูุง ููุฑุฏ ูุงุฒ ุจุฑุง ุงุฑุณุงู ุฏุฑุฎูุงุณุช
      headers:
        Content-Type: "application/json"
        Authorization: "Bearer your-secret-token" # ูุซุงู ุจุฑุง ูุฏุฑ ุงุญุฑุงุฒ ููุช
      # ุจุฏูู (Body) ุฏุฑุฎูุงุณุช ุจุง ูุฑูุช JSON
      # ุดูุง ูโุชูุงูุฏ ุงุฒ ูุชุบุฑูุง ูุงูุจ ุจุฑุง ุฌุงฺฏุฐุงุฑ ููุงุฏุฑ ุฏุงูุงูฺฉ ุงุณุชูุงุฏู ฺฉูุฏ
      json:
        # ูุชุบุฑ {{ .ServiceName }} ุจุง ูุงู ุณุฑูุณ ุฌุงฺฏุฒู ูโุดูุฏ
        message: "๐ด Alert: Service '{{ .ServiceName }}' is down!"
        # ูุชุบุฑ {{ .TimeStamp }} ุจุง ุฒูุงู ูููุน ุฎุทุง ุฌุงฺฏุฒู ูโุดูุฏ
        timestamp: "{{ .TimeStamp }}"
        details: "Request to {{ .URL }} failed."
```

---

## ๐๏ธ ุณุงุฎุชุงุฑ ูพุฑูฺู

ูุนูุงุฑ ูพุฑูฺู ุจู ุตูุฑุช ูุงฺููุงุฑ ุทุฑุงุญ ุดุฏู ุชุง ุจู ุฑุงุญุช ุจุชูุงู ูุงุจูุชโูุง ุฌุฏุฏ ุจู ุขู ุงุถุงูู ฺฉุฑุฏ.

```bash
.
โโโ config/         # ููุทู ุจุงุฑฺฏุฐุงุฑ ู ูพุฑุฏุงุฒุด ูุงู ฺฉุงููฺฏ YAML
โโโ healthcheck/    # ูุณุชู ุงุตู ุจุฑูุงูู ุจุฑุง ุงุฌุฑุง ุญูููโูุง ุจุฑุฑุณ ุณุฑูุณ
โโโ model/          # ุชุนุฑู ุณุงุฎุชุงุฑูุง (Structs) ูุงููุฏ Service, Notifier, Config
โโโ notifier/       # ุณุณุชู ุงุฑุณุงู ูุดุฏุงุฑ (ุงููุ ูพุงูฺฉ ู...)
โ   โโโ notifier.go # ุงูุชุฑูุณ ุงุตู ุจุฑุง Notifier ูุง
โ   โโโ registry.go # ูุฏุฑุช ู ุซุจุช Notifier ูุง ูุฎุชูู
โ   โโโ mail.go     # ูพุงุฏูโุณุงุฒ ุงุฑุณุงู ุงูู (SMTP)
โ   โโโ sms.go      # ูพุงุฏูโุณุงุฒ ุงุฑุณุงู ูพุงูฺฉ (IPPanel)
โโโ main.go         # ููุทู ูุฑูุฏ ู ููุงููฺฏโฺฉููุฏู ูุงฺููโูุง
โโโ sample.yaml     # ูุงู ููููู ูพฺฉุฑุจูุฏ
```

---

## ๐บ๏ธ ููุดู ุฑุงู ุขูุฏู (Roadmap)

- [ ] ุงูุฒูุฏู **Graceful Shutdown** ุจุง ุงุณุชูุงุฏู ุงุฒ `context` ุจุฑุง ูุฏุฑุช ุจูุชุฑ Goroutine ูุง.
- [ ] ูพุงุฏูโุณุงุฒ **Unit Test** ุจุฑุง ูุงฺููโูุง `healthcheck` ู `notifier`.
- [ ] ูพุดุชุจุงู ุงุฒ **ุจุฑุฑุณ ูุญุชูุง Response** ุจุง ุงุณุชูุงุฏู ุงุฒ ุนุจุงุฑุชโูุง ููุธู (Regex).
- [ ] ุงูุฒูุฏู Notifier ูุง ุจุดุชุฑ (ูุงููุฏ **Slack**, **Telegram**).
- [ ] ุฐุฎุฑู ูุงฺฏโูุง ุฏุฑ ฺฉ ูุงู ุง ูพุงฺฏุงู ุฏุงุฏู ุจุฑุง ุชุญููโูุง ุจุนุฏ.
- [ ] ุณุงุฎุช ฺฉ **ุฑุงุจุท ฺฉุงุฑุจุฑ ุชุญุช ูุจ (Web UI)** ุณุงุฏู ุจุฑุง ููุงุด ูุถุนุช ุขููุงู ุณุฑูุณโูุง.

---

## ๐ค ูุดุงุฑฺฉุช (Contributing)

ุงุฒ ูุฑฺฏููู ูุดุงุฑฺฉุช (PR ู Issue) ุจู ุดุฏุช ุงุณุชูุจุงู ูโุดูุฏ! ุงฺฏุฑ ุงุฏูโุง ุจุฑุง ุจูุชุฑ ุดุฏู ูพุฑูฺู ุฏุงุฑุฏุ ุฎูุดุญุงู ูโุดูู ุขู ุฑุง ุจุง ูุง ุฏุฑ ูุงู ุจฺฏุฐุงุฑุฏ.

ุจุฑุง ุชูุณุนู ฺฉุฏุ ูุทูุง ุงุตูู ุฒุฑ ุฑุง ุฏูุจุงู ฺฉูุฏ:
- ุฑุนุงุช **ูุฑุงุฑุฏุงุฏูุง ูุงูโฺฏุฐุงุฑ (Naming Conventions)** ุฏุฑ Go.
- ุทุฑุงุญ ูุจุชู ุจุฑ **ุงูุชุฑูุณ (Interface-based Design)** ุจุฑุง ุงูุนุทุงูโูพุฐุฑ ุจุดุชุฑ.
- ุงุณุชูุงุฏู ุงุฒ **ูุงฺฏุฑ (Logger)** ูุงุจู ฺฉูุชุฑู ุจุฑุง ุฏุจุงฺฏ ุจูุชุฑ.

---

## ๐ ูุงุณูุณ

**Mostafa Arshadi** (ุจุง ุงูุชุฎุงุฑุ ุจุฑุง ุงุฏฺฏุฑุ ูพุดุฑูุช ู ฺฉุงุฑ ุชู โค๏ธ)
